{{ define "main" }}

<header class="plans-index-header">
    <h1>Our Timeline ğŸ§¶</h1>
    <p class="plans-intro">From dreams to memories.</p>
</header>

<div class="timeline-wrapper">

    {{ $dated := where .Pages "Params.target_date" "ne" nil }}
    {{ $dated = where $dated "Params.target_date" "ne" "" }}
    
    {{ range ($dated.ByParam "target_date") }}
    
    {{ $isPast := false }}
    {{ if lt (.Params.target_date | time.AsTime) now }}
        {{ $isPast = true }}
    {{ end }}

    <div class="timeline-item">
        <div class="timeline-marker"></div>

        <div class="timeline-date">
            {{ .Params.target_date | time.Format "Jan 02" }}
            <span class="year">{{ .Params.target_date | time.Format "2006" }}</span>
        </div>

        <div class="timeline-content">
            <div class="timeline-card">
                
                <span class="status-pill {{ if $isPast }}completed{{ else }}{{ .Params.status | urlize }}{{ end }}">
                    {{ if $isPast }}
                        âœ… History
                    {{ else }}
                        {{ if eq .Params.status "Booked" }} ğŸŸï¸ Booked
                        {{ else }} ğŸ’­ Dreaming {{ end }}
                    {{ end }}
                </span>

                <h3><a href="{{ .RelPermalink }}" style="text-decoration: none; color: inherit;">{{ .Title }}</a></h3>
                
                {{ if .Params.location }}
                <p class="location">ğŸ“ {{ .Params.location }}</p>
                {{ end }}

                {{ if .Params.memory_link }}
                <div class="memory-bridge">
                    <a href="{{ .Params.memory_link }}" class="read-story-btn">
                        Read the Story ğŸ“¸
                    </a>
                </div>
                {{ end }}

            </div>
        </div>
    </div>
    {{ end }}

    <div class="timeline-break">
        <span> Someday / Dreaming â˜ï¸ </span>
    </div>

    {{ $undated := where .Pages "Params.target_date" "eq" nil }}
    {{ range $undated }}
    <div class="timeline-item dreaming-item">
        <div class="timeline-marker"></div>
        <div class="timeline-date">???</div>
        <div class="timeline-content">
            <a href="{{ .RelPermalink }}" class="timeline-card">
                <span class="status-pill {{ .Params.status | urlize }}">Dreaming</span>
                <h3>{{ .Title }}</h3>
            </a>
        </div>
    </div>
    {{ end }}

</div>

{{ end }}